---
title: "Data processing"
output: html_notebook
---

Ctrl + Shift + Enter - run cell.
Ctrl + Alt + I - insert new cell.
Ctrl + Shift + K - preview HTML result document.

# Download data

```{r}
file_path = './Data/OnlineNewsPopularity.csv'
data = read.csv(file_path)
```


```{r}
dim(data)
head(data)
```



## When the majority of the publications are written?

Questions to answer:
1. When the majority of publications are written
2. Check week_day_is_* parameter - may be articles, written on a certain day, had
the highest number of shares?

```{r}
par(mfrow = c(2, 2))

hist(data$weekday_is_friday)
hist(data$weekday_is_monday)
hist(data$weekday_is_saturday)
hist(data$weekday_is_sunday)

par(mfrow = c(1, 1))
```
```{r}
find_majority <- function(data_, columns){
  sizes = c()
  colnames = c()
  for(c in columns){
    size = dim(data_[data_[, c] == T, ])[1]
    sizes = append(sizes, size)
    colnames = append(colnames, c)
    #res = append(res, list('size' = size, 'column' = c))
  }
  # print(sizes)
  # print(which.max(sizes))
  cat('Maximum of articles is published on:', colnames[which.max(sizes)], max(sizes), 'articles', '\n')
  return(sizes)
}

articles_amount = find_majority(
  data, 
  columns = c(
    'weekday_is_monday', 
    'weekday_is_tuesday',
    'weekday_is_wednesday',
    'weekday_is_thursday',
    'weekday_is_friday',
    'weekday_is_saturday',
    'weekday_is_sunday'
  )
)

```
## Is there a difference in a number of shares, depending on the day of publication?

Here, we will use statistical tests.
For comparing number of shares on weekdays and weekends -> we will use t-test.
What are assumptions of t test?
1. Number of shares of one article is independent of number of shares of the other article (debatable)
2. Shares are normally distributed (not true, but for log transform might be true)
3. Have a similar amount of variance within each group

```{r}
par(mfrow = c(2, 2))
hist(data$shares)
hist(log(data$shares))

qqnorm(data$shares, pch = 1)
qqline(data$shares, col = "steelblue", lwd = 2)

qqnorm(log(data$shares), pch = 1)
qqline(log(data$shares), lwd = 2)

par(mfrow = c(1, 1))
```
```{r}
vec = seq(1:dim(data)[1])# vector(length = dim(data)[1])

vec[which(data$weekday_is_monday == T)] = 'mon'
vec[which(data$weekday_is_tuesday == T)] = 'tue'
vec[which(data$weekday_is_wednesday == T)] = 'wed'
vec[which(data$weekday_is_thursday == T)] = 'thur'
vec[which(data$weekday_is_friday == T)] = 'fri'
vec[which(data$weekday_is_saturday == T)] = 'sat'
vec[which(data$weekday_is_sunday == T)] = 'sun'

vec_factor = factor(
  vec, 
  levels = c('mon', 'tue', 'wed', 'thur', 'fri', 'sat', 'sun', labels = levels)
)

data$weekday = vec_factor
data$is_weekend = data$weekday_is_sunday | data$weekday_is_saturday
```


```{r}
weekend_data = data[data$is_weekend == T, 'shares']
workdays_data = data[data$is_weekend == F, 'shares']

log_weekend_data = log(weekend_data)
log_workdays_data = log(workdays_data)

par(mfrow = c(2, 2))

hist(log_weekend_data)

qqnorm(log_weekend_data)
qqline(log_weekend_data)

hist(log_workdays_data)

qqnorm(log_workdays_data)
qqline(log_workdays_data)

par(mfrow = c(1, 1))
```


```{r}
par(mfrow = c(2, 2))
hist(weekend_data)

qqnorm(weekend_data)
qqline(weekend_data)


hist(workdays_data)

qqnorm(workdays_data)
qqline(workdays_data)

par(mfrow = c(1, 1))
```


```{r}
par(mfrow = c(2, 2))

boxplot(data$shares ~ data$is_weekend, outline = F)
boxplot(data$shares ~ data$weekday, outline = F)

boxplot(log(data$shares) ~ data$is_weekend, outline = F)
boxplot(log(data$shares) ~ data$weekday, outline = F)

par(mfrow = c (1, 1))
```
If we work with log(Y) variable, it looks more like from normal distribution (QQ plot).
We cannot assume equal variances:


```{r}
test = var.test(log_weekend_data, log_workdays_data, var.equal = T)
if(test$p.value < 0.05){
  print('Variances are different!')
} else{
  test$p.value
}
```
So, here an important conclusion follows: t test for unequal variance shows that 
with high confidence p < 0.01 means are different. The articles, published
on weekends, have more shares. But this difference is negligible, though
statistically meaningful.

```{r}
t.test(
  log_weekend_data, log_workdays_data,
  var.equal = F
)
```

## Is there a prefered channel? Which channel is mostly shared?


```{r}
# data$data_channel_is_bus
# data$data_channel_is_entertainment
# data$data_channel_is_lifestyle
# data$data_channel_is_socmed
# data$data_channel_is_tech
# data$data_channel_is_world
boxplot(shares ~ data_channel_is_lifestyle, data = data, outline = F)
```
```{r}
vec = seq(1:dim(data)[1])# vector(length = dim(data)[1])

vec[which(data$data_channel_is_bus == T)] = 'bus'  # business
vec[which(data$data_channel_is_entertainment == T)] = 'ent'
vec[which(data$data_channel_is_lifestyle == T)] = 'life'
vec[which(data$data_channel_is_socmed == T)] = 'soc'
vec[which(data$data_channel_is_tech == T)] = 'tech'
vec[which(data$data_channel_is_world == T)] = 'world'

vec_factor = factor(
  vec, 
  levels = c('mon', 'tue', 'wed', 'thur', 'fri', 'sat', 'sun', labels = levels)
)

# data$weekday = vec_factor
# data$is_weekend = data$weekday_is_sunday | data$weekday_is_saturday
```



```{r}
unique(vec)
```







