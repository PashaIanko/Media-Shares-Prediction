---
title: "Data processing"
output: html_notebook
---

Ctrl + Shift + Enter - run cell.
Ctrl + Alt + I - insert new cell.
Ctrl + Shift + K - preview HTML result document.

```{r}
catn <- function(x, append="\n"){cat(x); cat(append)}
```


# Download data

```{r}
file_path = './Data/OnlineNewsPopularity_processed.csv'
data = read.csv(file_path)
print(dim(data))
head(data)
```


```{r}
data = data[, -1] # removing url column
head(data)
```


# Subsetting training data

```{r}
train_percent = 0.1

sample <- sample.int(
  n = nrow(data), 
  size = floor(train_percent*nrow(data)), 
  replace = F
)

train <- data[sample, ]
test  <- data[-sample, ]

cat('Train size', dim(train), '\n')
cat('Test size', dim(test), '\n')
```



# Simple linear model



```{r}
Y_colname = colnames(data)[length(colnames(data))]
X_colnames = colnames(data)[1 : length(colnames(data)) - 1]

X = as.matrix(data[, X_colnames])
Y = data[, Y_colname]

stopifnot(length(Y_colname) + length(X_colnames) == dim(data)[2])
```

```{r}
length(X_colnames)
```

```{r}
colnames(train[, 1:dim(train)[2] - 1])
```


## Full linear model

```{r}
full_model = lm(train[,Y_colname] ~ ., data = train[, 1 : dim(train)[2] - 1])
```


```{r}
summary(full_model)
```


```{r}
plot(data$shares, data$n_tokens_content, pch = 5)
abline(full_model)
```
```{r}
# To look at coefficients
# coefficients(full_model)

# Confidence intervals for coefficients
# confint(full_model)

# Residuals
# e = residuals(full_model)
```

```{r}
e <- residuals(full_model)
RSS <- sum(e^2)
RSS
```
```{r}
plot(train$n_tokens_content, residuals(train))
plot(train$average_token_length, residuals(train))
```



